{% extends "base.html" %}
{% block content %}
<h1>Admin Dashboard</h1>
<div class="row">
  <div class="col-md-4 mb-3">
    <div class="card p-3"><small class="muted">Total Products</small><h2>{{ stats.total }}</h2></div>
  </div>
  <div class="col-md-4 mb-3">
    <div class="card p-3"><small class="muted">Categories</small><h2>{{ stats.categories }}</h2></div>
  </div>
  <div class="col-md-4 mb-3">
    <div class="card p-3"><small class="muted">Latest</small><h2 class="h5">{{ stats.latest }}</h2></div>
  </div>
</div>
<div class="row">
  <div class="col-lg-7 mb-3">
    <div class="card p-3">
      <h5>Products by Category</h5>
      <canvas id="catChart" height="170"></canvas>
    </div>
  </div>
  <div class="col-lg-5 mb-3">
    <div class="card p-3">
      <h5>New Products (14 days)</h5>
      <canvas id="daysChart" height="170"></canvas>
    </div>
  </div>
</div>
<div class="d-flex">
  <a class="btn btn-outline-light" href="{{ url_for('admin_products') }}">Manage Products</a>
  <a class="btn btn-secondary ml-auto" href="{{ url_for('admin_logout') }}">Sign out</a>
</div>
{% endblock %}
{% block scripts %}
<script>
new Chart(document.getElementById('catChart'), {
  type: 'bar',
  data: { labels: {{ stats.cat_labels|tojson }}, datasets: [{ label: 'Products', data: {{ stats.cat_counts|tojson }} }] },
  options: { legend: { display: false }, scales:{ yAxes: [{ ticks: { beginAtZero:true } }] } }
});
new Chart(document.getElementById('daysChart'), {
  type: 'line',
  data: { labels: {{ stats.day_labels|tojson }}, datasets: [{ label: 'New', data: {{ stats.day_counts|tojson }}, fill:false, tension:.35 }] },
  options: { legend: { display: false }, scales:{ yAxes: [{ ticks: { beginAtZero:true } }] } }
});
</script>
{% endblock %}
